p←⍎¨↑⊃⎕NGET'3.input'1
(2⊥(≢p)≥⍨2×+⌿p)×2⊥(≢p)≤⍨2×+⌿p ⍝ Part 1: 1540244
r←{1=≢⍵:2⊥∨⌿⍵⋄d←(≢⍵)⍺⍺2×+/⍺⌷⍉⍵⋄(1+⍺)∇(d=⍺⌷⍉⍵)⌿⍵}⍝ Reducer.
1(≤r×>r)p ⍝ Part 2: 4203981
